[
  {
    "objectID": "time_series.html",
    "href": "time_series.html",
    "title": "Time Series Analysis",
    "section": "",
    "text": "The World Health Organization (WHO) estimates that about 300,000 women globally died from pregnancy-related deaths in 2017. On average, that’s about 800 each day.\nAccording to the ICD-11, maternal deaths are defined as the deaths of women while pregnant or within 42 days of termination of pregnancy, from pregnancy-related causes, but excluding accidental or incidental causes of death.\nHere, we perform a time series analysis of data collected from the Institute for Health Metrics and Evaluation (2024) (link) on the proportion of maternal deaths — defined as deaths from pregnancy-related causes of women while pregnant or within 42 days of termination of pregnancy, not including accidental or incidental causes — from maternal conditions caused by hypertensive disorders, such as gestational hypertension and preeclampsia. The data was originally sourced from the Our World In Data Maternal Mortality Report, which tracks maternal deaths and their causes and prevalence around the globe.\nThe below time series analysis uses annual data collected between 1980 and 2023 and aims to fit an ARIMA (Autoregressive Integrated Moving Average) model to the data in order to understand the underlying autocorrelation in the data and use these temporal dynamics to accurately forecast the future of maternal mortality due to hypertension.\n\n\nClick to see code\n# Read in data\nihme &lt;- read.csv(\"time_series/data/IHME-2023.csv\")\n# select relevant columns, order by year\nihme &lt;- ihme |&gt; select(year, val)\n\nihme$year &lt;- as.numeric(ihme$year)\n\n# order\nihme &lt;- ihme |&gt; arrange(year) |&gt; rename(mortality = val)\nhead(ihme)\n\n\n  year mortality\n1 1980  2.149895\n2 1981  1.871614\n3 1982  1.781776\n4 1983  1.810176\n5 1984  1.756494\n6 1985  1.703607\n\n\n\n\nClick to see code\nplot &lt;- ggplot(ihme, aes(year, mortality)) + \n  geom_point(color = \"#A8BBA3\", size = 0.9) +\n  geom_line(color = \"#A8BBA3\", size = 0.8) + \n  labs(title = \"Maternal Mortality Ratio from Hypertensive Disorders\\nin the United States, 1980-2023\",\n    x = \"Year\",\n    y = \"Mortality Ratio\") +\n  theme_minimal() + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA),\n    text = element_text(color = '#B87C4C'),\n    axis.text = element_text(color = '#B87C4C'),\n    axis.title = element_text(color = '#B87C4C'),\n    plot.title = element_text(color = '#B87C4C'),\n    plot.subtitle = element_text(color = '#B87C4C'),\n    legend.text = element_text(color = '#B87C4C'),\n    legend.title = element_text(color = '#B87C4C'),\n    strip.text = element_text(color = '#B87C4C'),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank())\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\nClick to see code\nggsave(\"img/maternal_mortality_timeseries.png\", plot = plot, width = 7, height = 4.5, dpi = 300, bg = \"#F7F1DE\")\n# manual title because of ggplotly\nggplotly(plot) |&gt; layout(title = list(\n  text = paste0(\n    \"Maternal Mortality Ratio from Hypertensive Disorders in the United States, 1980-2023\",\n    \"&lt;br&gt;&lt;span style='font-size:12px;'&gt;Deaths per 100,000 Live Births Due to Maternal Hypertensive Disorders&lt;/span&gt;\"\n  )\n))\n\n\n\n\n\n\nThe above line plot shows the series of maternal mortality rate caused by maternal hypertensive disorders like gestational hypertension and preeclampsia. The frequency of the data is yearly covering a 43-year time span, and shows an increasing rate of proportion of maternal deaths caused by hypertensive disorders over time. Tracking the proportion of deaths from these disorders rather than the number of deaths allows us to understand the impact of the disorders while controlling for general population growth.\nLooking at the plot, there are a couple of important points of interest. The first is a significant and steady decrease in the proportion of deaths caused by maternal hypertension between 1980 and 1990, which was likely caused by general improvements in maternal healthcare prenatal care in the US during that decade.\nThere has also been a significant increase in the mortality ratio in the last decade, with a particularly high spike in 2020. This spike coincides with the COVID-19 pandemic, which disrupted healthcare serives, limited access to prenatal care, and increased things like stress and comorbidities, all of which could have led to higher maternal mortality rates.\nIn the years following 2020, there has been a continuing decrease, which likely reflects the healthcare systems recovery from the pandemic."
  },
  {
    "objectID": "time_series.html#mortality-from-maternal-hypertensive-disorders-ihme",
    "href": "time_series.html#mortality-from-maternal-hypertensive-disorders-ihme",
    "title": "Time Series Analysis",
    "section": "",
    "text": "The World Health Organization (WHO) estimates that about 300,000 women globally died from pregnancy-related deaths in 2017. On average, that’s about 800 each day.\nAccording to the ICD-11, maternal deaths are defined as the deaths of women while pregnant or within 42 days of termination of pregnancy, from pregnancy-related causes, but excluding accidental or incidental causes of death.\nHere, we perform a time series analysis of data collected from the Institute for Health Metrics and Evaluation (2024) (link) on the proportion of maternal deaths — defined as deaths from pregnancy-related causes of women while pregnant or within 42 days of termination of pregnancy, not including accidental or incidental causes — from maternal conditions caused by hypertensive disorders, such as gestational hypertension and preeclampsia. The data was originally sourced from the Our World In Data Maternal Mortality Report, which tracks maternal deaths and their causes and prevalence around the globe.\nThe below time series analysis uses annual data collected between 1980 and 2023 and aims to fit an ARIMA (Autoregressive Integrated Moving Average) model to the data in order to understand the underlying autocorrelation in the data and use these temporal dynamics to accurately forecast the future of maternal mortality due to hypertension.\n\n\nClick to see code\n# Read in data\nihme &lt;- read.csv(\"time_series/data/IHME-2023.csv\")\n# select relevant columns, order by year\nihme &lt;- ihme |&gt; select(year, val)\n\nihme$year &lt;- as.numeric(ihme$year)\n\n# order\nihme &lt;- ihme |&gt; arrange(year) |&gt; rename(mortality = val)\nhead(ihme)\n\n\n  year mortality\n1 1980  2.149895\n2 1981  1.871614\n3 1982  1.781776\n4 1983  1.810176\n5 1984  1.756494\n6 1985  1.703607\n\n\n\n\nClick to see code\nplot &lt;- ggplot(ihme, aes(year, mortality)) + \n  geom_point(color = \"#A8BBA3\", size = 0.9) +\n  geom_line(color = \"#A8BBA3\", size = 0.8) + \n  labs(title = \"Maternal Mortality Ratio from Hypertensive Disorders\\nin the United States, 1980-2023\",\n    x = \"Year\",\n    y = \"Mortality Ratio\") +\n  theme_minimal() + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA),\n    text = element_text(color = '#B87C4C'),\n    axis.text = element_text(color = '#B87C4C'),\n    axis.title = element_text(color = '#B87C4C'),\n    plot.title = element_text(color = '#B87C4C'),\n    plot.subtitle = element_text(color = '#B87C4C'),\n    legend.text = element_text(color = '#B87C4C'),\n    legend.title = element_text(color = '#B87C4C'),\n    strip.text = element_text(color = '#B87C4C'),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank())\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\nClick to see code\nggsave(\"img/maternal_mortality_timeseries.png\", plot = plot, width = 7, height = 4.5, dpi = 300, bg = \"#F7F1DE\")\n# manual title because of ggplotly\nggplotly(plot) |&gt; layout(title = list(\n  text = paste0(\n    \"Maternal Mortality Ratio from Hypertensive Disorders in the United States, 1980-2023\",\n    \"&lt;br&gt;&lt;span style='font-size:12px;'&gt;Deaths per 100,000 Live Births Due to Maternal Hypertensive Disorders&lt;/span&gt;\"\n  )\n))\n\n\n\n\n\n\nThe above line plot shows the series of maternal mortality rate caused by maternal hypertensive disorders like gestational hypertension and preeclampsia. The frequency of the data is yearly covering a 43-year time span, and shows an increasing rate of proportion of maternal deaths caused by hypertensive disorders over time. Tracking the proportion of deaths from these disorders rather than the number of deaths allows us to understand the impact of the disorders while controlling for general population growth.\nLooking at the plot, there are a couple of important points of interest. The first is a significant and steady decrease in the proportion of deaths caused by maternal hypertension between 1980 and 1990, which was likely caused by general improvements in maternal healthcare prenatal care in the US during that decade.\nThere has also been a significant increase in the mortality ratio in the last decade, with a particularly high spike in 2020. This spike coincides with the COVID-19 pandemic, which disrupted healthcare serives, limited access to prenatal care, and increased things like stress and comorbidities, all of which could have led to higher maternal mortality rates.\nIn the years following 2020, there has been a continuing decrease, which likely reflects the healthcare systems recovery from the pandemic."
  },
  {
    "objectID": "time_series.html#decomposition",
    "href": "time_series.html#decomposition",
    "title": "Time Series Analysis",
    "section": "Decomposition",
    "text": "Decomposition\n\n\nClick to see code\nihme_ts &lt;- ts(ihme$mortality, start = 1980, frequency = 1)\n\n\ndecomposed = decompose(ihme_ts)  autoplot(decomposed)\nSince we can’t decompose annual data, we perform a moving average calculation to extract the trend component.\n\n\nClick to see code\n# centered moving average (NA at edges is expected)\ntrend_mortality &lt;- ma(ihme_ts, order = 6, centre = TRUE)\n\nplot_ly(x = ~time(ihme_ts)) |&gt;\n    add_lines(y = ~as.numeric(ihme_ts), name = \"Original\", line = list(color = \"#A8BBA3\")) |&gt;\n    add_lines(y = ~as.numeric(trend_mortality), name = \"Trend (MA)\", line = list(color = \"#B87C4C\", dash = \"dash\")) |&gt;\n    layout(\n        title = \"Maternal Mortality: Original vs Trend\", \n        xaxis = list(title = \"Year\"), \n        yaxis = list(title = \"Mortality Ratio\"),\n        plot_bgcolor = '#F7F1DE',\n        paper_bgcolor = '#F7F1DE')\n\n\n\n\n\n\nThe moving average calculation produces a smoother line without the randomness of the original series, showing the increasing trend of the data more clearly."
  },
  {
    "objectID": "time_series.html#lag-plots",
    "href": "time_series.html#lag-plots",
    "title": "Time Series Analysis",
    "section": "Lag Plots",
    "text": "Lag Plots\n\n\nClick to see code\ngglagplot(ihme_ts, do.lines=FALSE) +\n  xlab(\"Lags\") +\n  ylab(\"Yt\") +\n  ggtitle(\"Lag Plot for Maternal Hypertension Mortality\") + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\n\n\n\n\n\n\n\n\n\nThe lag plot shows the tighest and most elongated pattern along the 45-degree line at lag 1, which indicates a strong autocorrealtion between successive values, implying a strong relationship between current and immediate past values in the dataset. As the lags increase, the points become more scattered and dispersed, which indicates decreasing correlation between current and past values."
  },
  {
    "objectID": "time_series.html#acf-and-pacf",
    "href": "time_series.html#acf-and-pacf",
    "title": "Time Series Analysis",
    "section": "ACF and PACF",
    "text": "ACF and PACF\n\n\nClick to see code\nihme_acf &lt;- ggAcf(ihme_ts, main = \"ACF of Maternal Hypertension Mortality\")  + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\nihme_acf\n\n\n\n\n\n\n\n\n\nThe ACF plot shows high autocorrelation at many lags with a slow, gradual decay in the magnitude of that autocorrelation. This is an indicator that the data are non-stationary, and a hint that we may need to difference the data."
  },
  {
    "objectID": "time_series.html#augmented-dickey-fuller-test",
    "href": "time_series.html#augmented-dickey-fuller-test",
    "title": "Time Series Analysis",
    "section": "Augmented Dickey-Fuller Test",
    "text": "Augmented Dickey-Fuller Test\n\n\nClick to see code\nadf.test(ihme_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  ihme_ts\nDickey-Fuller = -1.3004, Lag order = 3, p-value = 0.8508\nalternative hypothesis: stationary\n\n\nThe ADF Test returns a p-value of.8508. This value is very high and well above the significance level of 0.05, so we fail to reject the null hypothesis, and can therefore conclude that the series is non-stationary.\nThe results from an ADF test alone can at times be unreliable, but this result combined with out observations of the ACF plot above provide strong evidence that our data is not stationary."
  },
  {
    "objectID": "time_series.html#differencing",
    "href": "time_series.html#differencing",
    "title": "Time Series Analysis",
    "section": "Differencing",
    "text": "Differencing\n\n\nClick to see code\ndiff_ihme &lt;- diff(ihme_ts)\n# Plot original vs. differenced\nacf_plot_1 &lt;- ggAcf(ihme_ts, 40) +\n    ggtitle(\"ACF of Original Series\") +\n    theme_minimal()  + \n    theme(\n        plot.background = element_rect(fill = '#F7F1DE', color = NA),\n        panel.background = element_rect(fill = '#F7F1DE', color = NA)\n    )\n\nacf_plot_2 &lt;- ggAcf(diff_ihme, 40) +\n    ggtitle(\"ACF of Differenced Series\") +\n    theme_minimal() + \n    theme(\n        plot.background = element_rect(fill = '#F7F1DE', color = NA),\n        panel.background = element_rect(fill = '#F7F1DE', color = NA)\n    )\n\n# Display plots side by side w/patchwork\n(acf_plot_1 / acf_plot_2) & plot_annotation(theme = theme(plot.margin = margin(0, 0, 0, 0)))\n\n\n\n\n\n\n\n\n\nAs evident in the ACF plots of the original and first-differenced data above, first-order differencing significantly reduces the autocorrelation across all lags. Therefore, first-order differencing is necessary for this data. First-order is sufficient and the data does not need second-order differencing."
  },
  {
    "objectID": "time_series.html#log-transformation",
    "href": "time_series.html#log-transformation",
    "title": "Time Series Analysis",
    "section": "Log Transformation",
    "text": "Log Transformation\n\n\nClick to see code\nlibrary(patchwork)\n\nihme$log_mortality &lt;- log(ihme$mortality)\nlog_ihme_ts &lt;- ts(ihme$log_mortality, start = 1980, frequency = 1)\n\n# Difference the Data\ndiff_ihme &lt;- diff(ihme_ts)\ndiff_log_ihme &lt;- diff(log_ihme_ts)\n\n# Plots for differenced data\np1 &lt;- ggplot() +\n  geom_line(aes(x = time(diff_ihme), y = diff_ihme), size = 0.9, color = \"#B87C4C\") +\n  labs(title = \"Differenced Mortality\",\n       x = \"Time\",\n       y = \"Differenced Mortality Ratio\") +\n  theme_minimal() + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\n\np2 &lt;- ggplot() +\n  geom_line(aes(x = time(diff_log_ihme), y = diff_log_ihme), size = 0.9, color = \"#51361f\") +\n  labs(title = \"Differenced Log-Transformed Mortality\",\n       x = \"Time\",\n       y = \"Differenced Log Mortality Ratio\") +\n  theme_minimal() + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\n\n# Combine plots\n(p1 / p2) & plot_annotation(theme = theme(plot.margin = margin(0, 0, 0, 0)))\n\n\n\n\n\n\n\n\n\nThe original series did not visually show extreme skew, outliers, or multiplicative relationship, but we performed a log-transformation anyway to confirm. The results of this above confirm that a log transformation is not necessary for this data."
  },
  {
    "objectID": "time_series.html#acfpacf-to-identify-arima-orders",
    "href": "time_series.html#acfpacf-to-identify-arima-orders",
    "title": "Time Series Analysis",
    "section": "ACF/PACF to identify ARIMA orders",
    "text": "ACF/PACF to identify ARIMA orders\n\n\nClick to see code\nihme_acf &lt;- ggAcf(ihme_ts, main = \"ACF of Maternal Hypertension Mortality\") + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\n\nihme_pacf &lt;- ggPacf(ihme_ts, main = \"PACF of Maternal Hypertension Mortality\") + \n  theme(\n    plot.background = element_rect(fill = '#F7F1DE', color = NA),\n    panel.background = element_rect(fill = '#F7F1DE', color = NA)\n  )\n\ngrid.arrange(ihme_acf, ihme_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nWe will consider the following parameter orders, based on the ACF and PACF plots above:\n\nd = 1 (plus d = 0 to test a wider variety of models)\nq = 0:3 (no further to maintain parsimony)\np = 1 (plus p = 0 to test a wider variety of models)"
  },
  {
    "objectID": "time_series.html#manual-arima-parameter-search",
    "href": "time_series.html#manual-arima-parameter-search",
    "title": "Time Series Analysis",
    "section": "Manual ARIMA Parameter search",
    "text": "Manual ARIMA Parameter search\n\n\nClick to see code\n# adapted from Gamage, P. (2026). Applied Time Series for Data Science.\n# Parameter ranges\np_range &lt;- 0:1\nd_range &lt;- 0:1\nq_range &lt;- 0:3\n\n# Create matrix to store results\nn_combinations &lt;- length(p_range) * length(d_range) * length(q_range)\nresults_matrix &lt;- matrix(NA, nrow = n_combinations, ncol = 6)\n\ni &lt;- 1\n# Loop through combinations of ARIMA model parameters\nfor (q in q_range) {\n  for (p in p_range) {\n    for (d in d_range) {\n\n      # Fit ARIMA model with specified (p,d,q)\n      model &lt;- Arima(ihme_ts, order = c(p, d, q), include.drift = TRUE)\n\n      # Store model parameters and AIC/BIC/AICc values in matrix\n      results_matrix[i, ] &lt;- c(p, d, q, model$aic, model$bic, model$aicc)\n\n      # Increment row index\n      i &lt;- i + 1\n    }\n  }\n}\n\n\n\n\nClick to see code\n# Convert matrix to data frame\nresults_df &lt;- as.data.frame(results_matrix)\ncolnames(results_df) &lt;- c(\"p\", \"d\", \"q\", \"AIC\", \"BIC\", \"AICc\")\n\n# Find row with min AIC\nhighlight_row &lt;- which.min(results_df$AIC)\n\n# Generate kable table with highlighting for the row with the lowest AIC\nknitr::kable(results_df, align = 'c', caption = \"Comparison of ARIMA Models\") |&gt;\n  kable_styling(full_width = FALSE, position = \"center\") |&gt;\n  row_spec(highlight_row, bold = TRUE, background = \"#FFFF99\")\n\n\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n\n\n\nComparison of ARIMA Models\n\n\np\nd\nq\nAIC\nBIC\nAICc\n\n\n\n\n0\n0\n0\n16.533362\n21.8859311\n17.133362\n\n\n0\n1\n0\n-23.474392\n-19.9519920\n-23.174392\n\n\n1\n0\n0\n-22.466189\n-15.3294301\n-21.440548\n\n\n1\n1\n0\n-22.141170\n-16.8575698\n-21.525786\n\n\n0\n0\n1\n-6.729143\n0.4076159\n-5.703502\n\n\n0\n1\n1\n-22.670004\n-17.3864035\n-22.054619\n\n\n1\n0\n1\n-20.636613\n-11.7156652\n-19.057666\n\n\n1\n1\n1\n-21.115038\n-14.0702378\n-20.062407\n\n\n0\n0\n2\n-10.986569\n-2.0656212\n-9.407622\n\n\n0\n1\n2\n-21.918207\n-14.8734062\n-20.865575\n\n\n1\n0\n2\n-19.433841\n-8.7287036\n-17.163571\n\n\n1\n1\n2\n-20.161381\n-11.3553807\n-18.539760\n\n\n0\n0\n3\n-12.584026\n-1.8788885\n-10.313756\n\n\n0\n1\n3\n-25.450682\n-16.6446811\n-23.829060\n\n\n1\n0\n3\n-23.296942\n-10.8076148\n-20.185831\n\n\n1\n1\n3\n-25.809335\n-15.2421343\n-23.476002\n\n\n\n\n\n\n\nThe manual search returned ARIMA(1,1,3) as the model with the lowest AIC."
  },
  {
    "objectID": "time_series.html#auto.arima",
    "href": "time_series.html#auto.arima",
    "title": "Time Series Analysis",
    "section": "Auto.arima()",
    "text": "Auto.arima()\n\n\nClick to see code\nauto_model &lt;- auto.arima(ihme_ts)\nauto_model\n\n\nSeries: ihme_ts \nARIMA(0,1,0) \n\nsigma^2 = 0.03116:  log likelihood = 13.56\nAIC=-25.13   AICc=-25.03   BIC=-23.37\n\n\nAuto.arima() returned ARIMA(0,1,0) (random walk) as the best model."
  },
  {
    "objectID": "time_series.html#model-diagnostics",
    "href": "time_series.html#model-diagnostics",
    "title": "Time Series Analysis",
    "section": "Model Diagnostics",
    "text": "Model Diagnostics\n\n\nClick to see code\nset.seed(5100)\n# ARIMA(1,1,3)\nmodel_output &lt;- capture.output(sarima(ihme_ts, 1, 1, 3))\n\n\n\n\n\n\n\n\n\nClick to see code\n# capture coefficient details\nstart_line &lt;- grep(\"Coefficients\", model_output)\nend_line &lt;- length(model_output)\ncat(model_output[start_line:end_line], sep = \"\\n\")\n\n\nCoefficients: \n         Estimate     SE t.value p.value\nar1        0.3462 0.2131  1.6242  0.1126\nma1       -0.7904 0.1820 -4.3438  0.0001\nma2        0.1521 0.1964  0.7748  0.4432\nma3        0.6068 0.1559  3.8913  0.0004\nconstant   0.0101 0.0320  0.3143  0.7550\n\nsigma^2 estimated as 0.0214264 on 38 degrees of freedom \n \nAIC = -0.6002171  AICc = -0.562505  BIC = -0.3544682 \n \n\n\n\n\nClick to see code\nset.seed(5100)\nmodel_output &lt;- capture.output(sarima(ihme_ts, 0, 1, 0))\n\n\n\n\n\n\n\n\n\nClick to see code\n# capture coefficient details\nstart_line &lt;- grep(\"Coefficients\", model_output)\nend_line &lt;- length(model_output)\ncat(model_output[start_line:end_line], sep = \"\\n\")\n\n\nCoefficients: \n         Estimate     SE t.value p.value\nconstant   0.0158 0.0268  0.5894  0.5587\n\nsigma^2 estimated as 0.03090565 on 42 degrees of freedom \n \nAIC = -0.5459161  AICc = -0.5436472  BIC = -0.4639998 \n \n\n\nThe Residual Plots for both ARIMA(3,1,2) and ARIMA(0,1,0) show fairly consistent fluctuation around zero, meaning the residuals are likely pretty close to stationary, which is an indication of strong-fitting models.\nThe ACF of the residuals of both ARIMA models has no significant autocorrelations.\nThe Q-Q Plot of both models shows the residuals closely following a normal distribution, with only slight deviations at the tails.\nThe Ljung-Box Test p-values are all above the 0.05 significance level for both models, which means there is little of autocorrelation remaining. The p-values are just slighly higher on average in the ARIMA(0,1,0) model compared to the ARIMA(1,1,3) model.\nIn the ARIMA(1,1,3) model, the ar1 and ma2 coefficients are insignificant, with p-values of 0.1126 and 0.4432, respectively. The ARIMA(0,1,0) model is much simpler and does not have variables/predictors.\nARIMA(0,1,0) is more parsimonious than ARIMA(1,1,3) and demonstrates slightly more significance in the LB test, but it is a very simplistic model. We ran model diagnostics on some other, higher order ARIMA models and the one below produced equally strong diagnostic plots.\n\n\nClick to see code\nset.seed(5100)\n# try: ARIMA(2,1,2)\nmodel_output &lt;- capture.output(sarima(ihme_ts, 2, 1, 2))\n\n\n\n\n\n\n\n\n\nClick to see code\n# capture coefficient details\nstart_line &lt;- grep(\"Coefficients\", model_output)\nend_line &lt;- length(model_output)\ncat(model_output[start_line:end_line], sep = \"\\n\")\n\n\nCoefficients: \n         Estimate     SE  t.value p.value\nar1        0.5183 0.1061   4.8846  0.0000\nar2       -0.8504 0.1022  -8.3185  0.0000\nma1       -0.9389 0.0857 -10.9562  0.0000\nma2        1.0000 0.1116   8.9601  0.0000\nconstant   0.0208 0.0177   1.1698  0.2494\n\nsigma^2 estimated as 0.02120203 on 38 degrees of freedom \n \nAIC = -0.6144113  AICc = -0.5766992  BIC = -0.3686625 \n \n\n\nARIMA(2,1,2) produces very similar diagnostic plots, but also comes with the added addvantages of a lower AIC value and all significant coefficients. Therefore, we will proceed with this model."
  },
  {
    "objectID": "time_series.html#benchmark-error-and-forecast-comparison",
    "href": "time_series.html#benchmark-error-and-forecast-comparison",
    "title": "Time Series Analysis",
    "section": "Benchmark Error and Forecast Comparison",
    "text": "Benchmark Error and Forecast Comparison\n\n\nClick to see code\n# Fit ARIMA model & show summary\nfit &lt;- Arima(ihme_ts, order = c(2,1,2), include.drift = FALSE)\n# summary(fit)\n\nacc &lt;- accuracy(fit)\nmae &lt;- acc[1, \"MAE\"]\nmse &lt;- (acc[1, \"RMSE\"])^2  \n\n# mean fit\nmean_fit &lt;- meanf(ihme_ts)\nmean_acc &lt;- accuracy(mean_fit)\nmean_mae &lt;- mean_acc[1, \"MAE\"]\nmean_mse &lt;- (mean_acc[1, \"RMSE\"])^2\n\n# naive fit\nnaive_fit &lt;- naive(ihme_ts)\nnaive_acc &lt;- accuracy(naive_fit)\nnaive_mae &lt;- naive_acc[1, \"MAE\"]\nnaive_mse &lt;- (naive_acc[1, \"RMSE\"])^2\n\n# drift fit\ndrift_fit &lt;- rwf(ihme_ts)\ndrift_acc &lt;- accuracy(drift_fit)\ndrift_mae &lt;- drift_acc[1, \"MAE\"]\ndrift_mse &lt;- (drift_acc[1, \"RMSE\"])^2\n\n# Results table\nresults &lt;- data.frame(\n  Model = c(\"ARIMA(2,1,2)\", \"Mean\", \"Naive\", \"Drift\"),\n  MAE = c(mae, mean_mae, naive_mae, drift_mae),\n  MSE = c(mse, mean_mse, naive_mse, drift_mse)\n)\n\n# Display table\nknitr::kable(results, digits = 3, caption = \"MAE and MSE for Each Model\")\n\n\n\nMAE and MSE for Each Model\n\n\nModel\nMAE\nMSE\n\n\n\n\nARIMA(2,1,2)\n0.110\n0.021\n\n\nMean\n0.332\n0.189\n\n\nNaive\n0.130\n0.031\n\n\nDrift\n0.130\n0.031\n\n\n\n\n\nThe ARIMA model, compared to the Benchmarks, achieves the lowest mean absolute error and mean squared error.\n\n\nClick to see code\n# Generate forecasts\nmean_forecast &lt;- meanf(ihme_ts, h = 10)\nnaive_forecast &lt;- naive(ihme_ts, h = 10)\ndrift_forecast &lt;- rwf(ihme_ts, drift = TRUE, h = 10)\narima_forecast &lt;- forecast(fit, h = 10)\n\n# Convert forecasts to data frames\nmean_df &lt;- data.frame(Date = time(mean_forecast$mean), Mean = as.numeric(mean_forecast$mean))\nnaive_df &lt;- data.frame(Date = time(naive_forecast$mean), Naive = as.numeric(naive_forecast$mean))\ndrift_df &lt;- data.frame(Date = time(drift_forecast$mean), Drift = as.numeric(drift_forecast$mean))\narima_df &lt;- data.frame(Date = time(arima_forecast$mean), ARIMA_Fit = as.numeric(arima_forecast$mean))\n\n\n\n\nClick to see code\n# Original data\nihme_ts_df &lt;- data.frame(Date = time(ihme_ts), Price = as.numeric(ihme_ts))\n\n# Create Plotly plot\nplot_ly() |&gt;\n  add_lines(data = ihme_ts_df, x = ~Date, y = ~Price, name = 'Original Data', line = list(color = 'black')) |&gt;\n  add_lines(data = mean_df, x = ~Date, y = ~Mean, name = 'Mean Forecast', line = list(color = 'blue')) |&gt;\n  add_lines(data = naive_df, x = ~Date, y = ~Naive, name = 'Naïve Forecast', line = list(color = 'red')) |&gt;\n  add_lines(data = drift_df, x = ~Date, y = ~Drift, name = 'Drift Forecast', line = list(color = 'green')) |&gt;\n  add_lines(data = arima_df, x = ~Date, y = ~ARIMA_Fit, name = 'ARIMA Fit', line = list(color = 'purple')) |&gt;\n  layout(title = 'Maternal Hypertension Mortality Ratio Forecast',\n         xaxis = list(title = 'Date'),\n         yaxis = list(title = 'Ratio'),\n         legend = list(title = list(text = 'Forecast Methods')),\n         plot_bgcolor = '#F7F1DE',\n         paper_bgcolor = '#F7F1DE')\n\n\n\n\n\n\nIt is clear that the ARIMA model provides a better fit and forecast than the simple baseline models."
  },
  {
    "objectID": "time_series.html#final-arima212-forecast",
    "href": "time_series.html#final-arima212-forecast",
    "title": "Time Series Analysis",
    "section": "Final ARIMA(2,1,2) Forecast",
    "text": "Final ARIMA(2,1,2) Forecast\nFinally, we isolate and plot the ARIMA forecast to observe the model’s 10-year prediction.\n\n\nClick to see code\nforecast_result &lt;- forecast(fit, h = 10)\n\n# Plot\nautoplot(forecast_result) +\n  labs(title = \"ARIMA(2,1,2) Forecast For Maternal Hypertension Mortality Ratio\",\n       x = \"Time\",\n       y = \"Predicted Price\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe forecasted mortality rate for the next 10 years appears to fit the shape and behavior as the historical mortality rate, and the confience interval is conservative and wide, but still within what appears to be an acceptable range. The forecast shows that the proportion of deaths caused by maternal hypertensive disorders will continue to oscillate as it has done in the past, but will generally stay close to the current level. This means that, according to the forecast, the rate will continue to stay below its COVID-19 peak, but it will not stabilize or reduce further in the next decade. If this forecast is considered seriously, it serves as a sign that further action — for example, improvements to the healthcare system and expanded access to it — will be necessary."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "[fully explain and describe the problem, why it matters, guiding questions]\nThis project uses probabilistic modeling and statistical hypothesis testing to investigate whether pre-existing chronic conditions — specifically hypertension and diabetes — impact pregnancy and birth outcomes, such as gestational duration (preterm vs. full-term), delivery method (vaginal vs. cesarean), and neonatal health indicators (birth weight, APGAR scores, NICU admission). This addresses a clinically significant question with clear public health implications.\n\n\n\n \n\nThis project uses the Vital Statistics Natality Birth Data (National Center for Health Statistics 2024), which uses natality data from the National Vital Statistics System of the National Center for Health Statistics and is distributed by the National Bureau of Economic Research (NBER). The dataset includes demographic data — such as date of birth, age and educational attainment of parents, marital status, live-birth order, race, sex, and geographic area — and health data — including birth weight, gestation, prenatal care, attendant at birth, and Apgar score — for births occurring during the calendar year.\nThe full dataset contains 237 features across 3,638,436 rows/items. For this project, our data is a random sample of this full dataset of 10,000 rows, subsetted down to 43 features. The features capture the main maternal conditions/risk factors, primary birth outcomes of interest, and selected potential covariates such as mother’s race and age.\n\n\n\nPrior to analysis, we clean the data and peform exploratory data analysis in Python and R to understand the structure, distributions, and relationships of all of the features of the Natality dataset. The EDA captures in various data visualizations that can be found on the Exploratory Data Analysis page.\n\n\n\nWe perform various types of hypothesis testing methods in R to ____. These analyses can be found on the Hypothesis Testing page.\n\nt-tests\nChi-square tests\nBootstrap methods\nANOVA\n\n\n\n\nWe also perform time series analysis on two time-varying variables from the supplemental dataset, TBD. For this data, we perfom separate time series exploratory data analysis, fit appropriate ARIMA models to the data, and evaluate the models with model diagnostic techniques. The time series analysis is located in the Time Series tab.\n\n\n\nThe findings of our analyses culminate in a written report that can be found in the Report tab.\n \n\n\n\n\n\n\n\nTwo-sample t-tests (for comparing mean values of two groups to see if difference is significant)\n\nIdeas:\n\nCompare average gestational age between mothers with vs. without hypertension\nCompare mean birth weights between diabetic vs. non-diabetic mothers\n\nChi-square Test for independence (if 2 variables are categorical associated or independent)\n\nIdeas:\n\nTest if delivery type (vaginal/cesarean) is independent of diabetes status\nTest association between having chronic condition and preterm birth (yes/no)\n\n\nMonte Carlo Simulation\n\nGenerate predicted distributions of birth weights given maternal health conditions\nSimulate pregnancy outcomes under different chronic condition prevalence scenarios\n\n\n\n\nHypothesis Testing (use each at least once or twice):\n\nt-tests\nChi-square tests\nBootstrap methods\nANOVA\nIf any assumption is violated (e.g., normality, equal variances), choose the appropriate non-parametric alternative. Make sure to do the relevant tests to see if these assumptions violates.\n\n\nTime Series Analysis:\n\nYou must analyze at least two time-varying variables.\nUse appropriate time-series modeling techniques (e.g., ARIMA, TS EDA).\nModel Diagnostics"
  },
  {
    "objectID": "index.html#data",
    "href": "index.html#data",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "This project uses the Vital Statistics Natality Birth Data (National Center for Health Statistics 2024), which uses natality data from the National Vital Statistics System of the National Center for Health Statistics and is distributed by the National Bureau of Economic Research (NBER). The dataset includes demographic data — such as date of birth, age and educational attainment of parents, marital status, live-birth order, race, sex, and geographic area — and health data — including birth weight, gestation, prenatal care, attendant at birth, and Apgar score — for births occurring during the calendar year.\nThe full dataset contains 237 features across 3,638,436 rows/items. For this project, our data is a random sample of this full dataset of 10,000 rows, subsetted down to 43 features. The features capture the main maternal conditions/risk factors, primary birth outcomes of interest, and selected potential covariates such as mother’s race and age."
  },
  {
    "objectID": "index.html#exploratory-data-analysis",
    "href": "index.html#exploratory-data-analysis",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "Prior to analysis, we clean the data and peform exploratory data analysis in Python and R to understand the structure, distributions, and relationships of all of the features of the Natality dataset. The EDA captures in various data visualizations that can be found on the Exploratory Data Analysis page."
  },
  {
    "objectID": "index.html#statistical-methods",
    "href": "index.html#statistical-methods",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "We perform various types of hypothesis testing methods in R to ____. These analyses can be found on the Hypothesis Testing page.\n\nt-tests\nChi-square tests\nBootstrap methods\nANOVA"
  },
  {
    "objectID": "index.html#time-series-analysis",
    "href": "index.html#time-series-analysis",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "We also perform time series analysis on two time-varying variables from the supplemental dataset, TBD. For this data, we perfom separate time series exploratory data analysis, fit appropriate ARIMA models to the data, and evaluate the models with model diagnostic techniques. The time series analysis is located in the Time Series tab."
  },
  {
    "objectID": "index.html#report",
    "href": "index.html#report",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "The findings of our analyses culminate in a written report that can be found in the Report tab.\n \n\n\n\n\n\n\n\nTwo-sample t-tests (for comparing mean values of two groups to see if difference is significant)\n\nIdeas:\n\nCompare average gestational age between mothers with vs. without hypertension\nCompare mean birth weights between diabetic vs. non-diabetic mothers\n\nChi-square Test for independence (if 2 variables are categorical associated or independent)\n\nIdeas:\n\nTest if delivery type (vaginal/cesarean) is independent of diabetes status\nTest association between having chronic condition and preterm birth (yes/no)\n\n\nMonte Carlo Simulation\n\nGenerate predicted distributions of birth weights given maternal health conditions\nSimulate pregnancy outcomes under different chronic condition prevalence scenarios\n\n\n\n\nHypothesis Testing (use each at least once or twice):\n\nt-tests\nChi-square tests\nBootstrap methods\nANOVA\nIf any assumption is violated (e.g., normality, equal variances), choose the appropriate non-parametric alternative. Make sure to do the relevant tests to see if these assumptions violates.\n\n\nTime Series Analysis:\n\nYou must analyze at least two time-varying variables.\nUse appropriate time-series modeling techniques (e.g., ARIMA, TS EDA).\nModel Diagnostics"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos."
  },
  {
    "objectID": "about.html#katie-dipaolo",
    "href": "about.html#katie-dipaolo",
    "title": "About",
    "section": "",
    "text": "Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos."
  },
  {
    "objectID": "about.html#alison-manna",
    "href": "about.html#alison-manna",
    "title": "About",
    "section": "Alison Manna",
    "text": "Alison Manna\n\nAlison is a second‑year Master’s student in Data Science and Analytics at Georgetown University. Originally from New York, she holds a BA in linguistics from Georgetown and has prior experience in finance and commercial real estate. She is interested in applying her computational and statistical skills in business settings and industries at the emerging stage of data and AI adoption to support business decisions using the latest innovations in data science."
  },
  {
    "objectID": "about.html#akshay-arun",
    "href": "about.html#akshay-arun",
    "title": "About",
    "section": "Akshay Arun",
    "text": "Akshay Arun\n\nLorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos."
  },
  {
    "objectID": "about.html#alexa-nakanishi",
    "href": "about.html#alexa-nakanishi",
    "title": "About",
    "section": "Alexa Nakanishi",
    "text": "Alexa Nakanishi\n\nLorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos."
  },
  {
    "objectID": "hypothesis_testing.html",
    "href": "hypothesis_testing.html",
    "title": "Hypothesis Testing",
    "section": "",
    "text": "Introduction/Background\nexplain questions we try to answer with the hypothesis tests & how they work\n\nWelch’s two-sample t-Test (unequal variances)Chi-Squared TestBootstrapANOVA\n\n\n\nQuestion: Do births to mothers with a chronic condition (diabetes or hypertension) have a different mean detailed birth weight (dbwt) than births to mothers without a chronic condition?\n\n\n\nNull hypothesis (\\(H_0\\)): \\(\\mu_{chronic} = \\mu_{nonchronic}\\) — the mean birth weight is the same for the chronic and non‑chronic groups.\nAlternative hypothesis (\\(H_1\\)): \\(\\mu_{chronic} \\neq \\mu_{nonchronic}\\) — the mean birth weight differs between the two groups.\n\nHypothesis test: two-sample t-test using R’s t.test() function to compare the means of the two independent groups with unequal variances.\n\n\nClick to see code\ndf &lt;- read.csv(\"data/cleaned/natality_cleaned.csv\")\n\n#detailed birth weight \noutcome &lt;- \"dbwt\"\n\n#creating chronic condition flag based on columns (true = chronic)\ndf$chronic_condition &lt;- ifelse(\n  df$rf_pdiab == 1 | df$rf_gdiab == 1 |\n  df$rf_phype == 1 | df$rf_ghype == 1 |\n  df$rf_ehype == 1,\n  1, 0\n)\n\n#splitting into chronic vs non-chronic groups \ngroup_chronic &lt;- df %&gt;%\n  filter(chronic_condition == 1) %&gt;%\n  pull(outcome)\n\ngroup_nonchronic &lt;- df %&gt;%\n  filter(chronic_condition == 0) %&gt;%\n  pull(outcome)\n\n#running independent samples t-test \nt_test_result &lt;- t.test(group_chronic, group_nonchronic)\n\nprint(\"T-Test Results:\")\n\n\n[1] \"T-Test Results:\"\n\n\nClick to see code\nprint(t_test_result)\n\n\n\n    Welch Two Sample t-test\n\ndata:  group_chronic and group_nonchronic\nt = -8.6312, df = 2928.5, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -132.09633  -83.18935\nsample estimates:\nmean of x mean of y \n 3202.622  3310.265 \n\n\n[interpretation]\n\n\n\nQuestion: Are different chronic conditions independent of admission to NICU?\n\n\n\nNull hypothesis (\\(H_0\\)): The chronic condition (e.g., diabetes or hypertension) and NICU admission are independent.\nAlternative hypothesis (\\(H_1\\)): The chronic condition and NICU admission are not independent (i.e., there is an association between them).\n\n\n\nDataset\n\n\nClick to see code\ndf &lt;- read_csv(\"data/cleaned/natality_cleaned.csv\")\n\nknitr::kable(head(df), caption = \"Natality Dataset\")\n\n\n\nNatality Dataset\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nbfacil\nmager\nmrace6\ndmar\nmeduc\nprecare\nbmi\nrf_pdiab\nrf_gdiab\nrf_phype\nrf_ghype\nrf_ehype\nno_risks\nip_gon\nip_syph\nip_chlam\nip_hepb\nip_hepc\nno_infec\nld_indl\nld_augm\nld_ster\nld_antb\nld_chor\nld_anes\nme_rout\nmm_mtr\nmm_plac\nmm_rupt\nmm_uhyst\nmm_aicu\napgar5\ndplural\nsex\ncombgest\ndbwt\nab_aven1\nab_aven6\nab_nicu\nab_surf\nab_anti\nab_seiz\nno_abnorm\n\n\n\n\nHospital\n26\nWhite\nUnmarried\nSome college credit, not a degree\n6\n24.2\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nTRUE\nTRUE\nFALSE\nFALSE\nFALSE\nTRUE\nSpontaneous\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nF\n39\n3150\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\nHospital\n20\nWhite\nUnmarried\nSome college credit, not a degree\n1\n20.4\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nSpontaneous\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nF\n41\n2466\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\nHospital\n29\nAsian\nMarried\nDoctorate\n2\n19.5\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nCesarean\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nF\n39\n2620\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\nHospital\n18\nWhite\nMarried\n9th-12th no diploma\n4\n33.4\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nSpontaneous\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nM\n40\n3360\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\nOther\n25\nWhite\nMarried\nSome college credit, not a degree\n4\n23.0\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nSpontaneous\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nM\n39\n2930\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\nHospital\n40\nBlack\nUnmarried\nBachelor’s degree\n9\n20.6\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\nCesarean\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n9\n1\nM\n39\n3572\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\nTRUE\n\n\n\n\n\n\n\n\nChi-Squared Tests, using R’s chisq()\n\n\nPre-existing Diabetes\n\n\nClick to see code\nchisq &lt;- function(A){\n  chisq.test(A)\n}\n\n# pre exsting diabetes\ntab1 &lt;- table(df$rf_pdiab, df$ab_nicu, dnn = c(\"Pre-existing Diabetes\", \"NICU Admission\"))\n# tab1\nknitr::kable(tab1, caption = \"Observed Counts of Pre-existing Diabetes vs. NICU Admission\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nObserved Counts of Pre-existing Diabetes vs. NICU Admission\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n9141\n740\n\n\nTRUE\n84\n35\n\n\n\n\n\nClick to see code\nchi_tab1 &lt;- chisq(tab1)\nchi_tab1\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  A\nX-squared = 76.007, df = 1, p-value &lt; 2.2e-16\n\n\nClick to see code\n# chi_tab1$expected\nknitr::kable(chi_tab1$expected, caption = \"Expected Counts Under Independence (Pre-existing Diabetes vs. NICU Admission)\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nExpected Counts Under Independence (Pre-existing Diabetes vs. NICU Admission)\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n9115.2225\n765.7775\n\n\nTRUE\n109.7775\n9.2225\n\n\n\n\n\n\n\n\nGestational Diabetes\n\n\nClick to see code\n# gestational diabetes\ntab2 &lt;- table(df$rf_gdiab, df$ab_nicu, dnn = c(\"Gestational Diabetes\", \"NICU Admission\"))\n# tab2\nknitr::kable(tab2, caption = \"Observed Counts of Gestational Diabetes vs. NICU Admission\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nObserved Counts of Gestational Diabetes vs. NICU Admission\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8494\n694\n\n\nTRUE\n731\n81\n\n\n\n\n\nClick to see code\nchi_tab2 &lt;- chisq(tab2)\nchi_tab2\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  A\nX-squared = 5.7876, df = 1, p-value = 0.01614\n\n\nClick to see code\n# chi_tab2$expected\nknitr::kable(chi_tab2$expected, caption = \"Expected Counts Under Independence (Gestational Diabetes vs. NICU Admission)\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nExpected Counts Under Independence (Gestational Diabetes vs. NICU Admission)\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8475.93\n712.07\n\n\nTRUE\n749.07\n62.93\n\n\n\n\n\n\n\n\nPre-pregnancy Hypertension\n\n\nClick to see code\n# pre-pregnancy hypertension\ntab3 &lt;- table(df$rf_phype, df$ab_nicu, dnn = c(\"Pre-Pregnancy Hypertension\", \"NICU Admission\"))\n# tab3\nknitr::kable(tab3, caption = \"Observed Counts of Pre-pregnancy Hypertension vs. NICU Admission\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nObserved Counts of Pre-pregnancy Hypertension vs. NICU Admission\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8945\n733\n\n\nTRUE\n280\n42\n\n\n\n\n\nClick to see code\nchi_tab3 &lt;- chisq(tab3)\nchi_tab3\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  A\nX-squared = 12.286, df = 1, p-value = 0.0004563\n\n\nClick to see code\n# chi_tab3$expected\nknitr::kable(chi_tab3$expected, caption = \"Expected Counts Under Independence (Pre-Pregnancy Hypertension vs. NICU Admission)\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nExpected Counts Under Independence (Pre-Pregnancy Hypertension vs. NICU Admission)\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8927.955\n750.045\n\n\nTRUE\n297.045\n24.955\n\n\n\n\n\n\n\n\nGestational Hypertension\n\n\nClick to see code\n# gestational hypertension\ntab4 &lt;- table(df$rf_ghype, df$ab_nicu, dnn = c(\"Gestational Hypertension\", \"NICU Admission\"))\n# tab4\nknitr::kable(tab4, caption = \"Observed Counts of Gestational Hypertension vs. NICU Admission\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nObserved Counts of Gestational Hypertension vs. NICU Admission\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8396\n658\n\n\nTRUE\n829\n117\n\n\n\n\n\nClick to see code\nchi_tab4 &lt;- chisq(tab4)\nchi_tab4\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  A\nX-squared = 30.456, df = 1, p-value = 3.416e-08\n\n\nClick to see code\n# chi_tab4$expected\nknitr::kable(chi_tab4$expected, caption = \"Expected Counts Under Independence (Gestational Hypertension vs. NICU Admission)\", row.names = TRUE, col.names = c(\"No NICU Admission\", \"NICU Admission\"))\n\n\n\nExpected Counts Under Independence (Gestational Hypertension vs. NICU Admission)\n\n\n\nNo NICU Admission\nNICU Admission\n\n\n\n\nFALSE\n8352.315\n701.685\n\n\nTRUE\n872.685\n73.315\n\n\n\n\n\n\n\n\n\nQuestion: Can we use bootstrap resampling to estimate the sampling distribution and confidence intervals for the mean birth weight in chronic vs. non-chronic condition groups, and assess the robustness of the observed mean difference?\n\n\n\nData Preparation\n\n\nClick to see code\ndf &lt;- read.csv(\"data/cleaned/natality_cleaned.csv\")\n\n# Detailed birth weight \noutcome &lt;- \"dbwt\"\n\n# Creating chronic condition flag based on columns (true = chronic)\ndf$chronic_condition &lt;- ifelse(\n  df$rf_pdiab == 1 | df$rf_gdiab == 1 |\n  df$rf_phype == 1 | df$rf_ghype == 1 |\n  df$rf_ehype == 1,\n  1, 0\n)\n\n# Splitting into chronic vs non-chronic groups \ngroup_chronic &lt;- df %&gt;%\n  filter(chronic_condition == 1) %&gt;%\n  pull(outcome)\n\ngroup_nonchronic &lt;- df %&gt;%\n  filter(chronic_condition == 0) %&gt;%\n  pull(outcome)\n\n\n\n\n\nOriginal Data Histograms\n\n\nClick to see code\n# ===== PART 1: Original Data Histograms with Normal Overlay =====\n# Save figure to file\npng(\"plots/original_data_histograms.png\", width = 1200, height = 600, res = 100)\npar(mfrow = c(1, 2))\n\n# Histogram for chronic group with normal overlay\nhist(group_chronic, breaks = 50, freq = FALSE, \n     main = \"Birth Weight - Chronic Conditions\",\n     xlab = \"Birth Weight (grams)\", \n     col = \"coral\", border = \"white\")\n# Add normal curve overlay\nmean_chronic &lt;- mean(group_chronic, na.rm = TRUE)\nsd_chronic &lt;- sd(group_chronic, na.rm = TRUE)\ncurve(dnorm(x, mean = mean_chronic, sd = sd_chronic), \n      col = \"darkred\", lwd = 2, add = TRUE)\nlegend(\"topright\", legend = \"Normal Dist\", col = \"darkred\", lwd = 2)\n\n# Histogram for non-chronic group with normal overlay\nhist(group_nonchronic, breaks = 50, freq = FALSE,\n     main = \"Birth Weight - No Chronic Conditions\",\n     xlab = \"Birth Weight (grams)\", \n     col = \"steelblue\", border = \"white\")\n# Add normal curve overlay\nmean_nonchronic &lt;- mean(group_nonchronic, na.rm = TRUE)\nsd_nonchronic &lt;- sd(group_nonchronic, na.rm = TRUE)\ncurve(dnorm(x, mean = mean_nonchronic, sd = sd_nonchronic), \n      col = \"darkblue\", lwd = 2, add = TRUE)\nlegend(\"topright\", legend = \"Normal Dist\", col = \"darkblue\", lwd = 2)\ndev.off()  # Close the saved figure\n\n\nquartz_off_screen \n                2 \n\n\n\n\n\nOriginal Data Histogram\n\n\n\n\n\nBootstrap Sampling & Distribution Histograms\n\n\nClick to see code\n# ===== PART 2: Bootstrap Sampling =====\nset.seed(5100)\nB &lt;- 10000\n\n# Bootstrap for chronic group\nboot_mean_chronic &lt;- numeric(B)\nn_chronic &lt;- length(group_chronic)\n\nfor(i in 1:B) {\n  boot_sample &lt;- sample(group_chronic, n_chronic, replace = TRUE)\n  boot_mean_chronic[i] &lt;- mean(boot_sample)\n}\n\n# Bootstrap for non-chronic group\nboot_mean_nonchronic &lt;- numeric(B)\nn_nonchronic &lt;- length(group_nonchronic)\n\nfor(i in 1:B) {\n  boot_sample &lt;- sample(group_nonchronic, n_nonchronic, replace = TRUE)\n  boot_mean_nonchronic[i] &lt;- mean(boot_sample)\n}\n\n\n\n\nClick to see code\n# ===== PART 3: Bootstrap Distribution Histograms with Normal Overlay =====\n# Save figure to file\npng(\"plots/bootstrap_distributions.png\", width = 1200, height = 600, res = 100)\npar(mfrow = c(1, 2))\n\n# Histogram for bootstrap chronic distribution with normal overlay\nhist(boot_mean_chronic, breaks = 50, freq = FALSE,\n     main = \"Bootstrap Dist - Chronic Mean Birth Weight\",\n     xlab = \"Mean Birth Weight (grams)\", \n     col = \"coral\", border = \"white\")\n# Add normal curve overlay\nboot_mean_chronic_mean &lt;- mean(boot_mean_chronic)\nboot_mean_chronic_sd &lt;- sd(boot_mean_chronic)\ncurve(dnorm(x, mean = boot_mean_chronic_mean, sd = boot_mean_chronic_sd), \n      col = \"darkred\", lwd = 2, add = TRUE)\nlegend(\"topright\", legend = \"Normal Dist\", col = \"darkred\", lwd = 2)\n\n# Histogram for bootstrap non-chronic distribution with normal overlay\nhist(boot_mean_nonchronic, breaks = 50, freq = FALSE,\n     main = \"Bootstrap Dist - Non-Chronic Mean Birth Weight\",\n     xlab = \"Mean Birth Weight (grams)\", \n     col = \"steelblue\", border = \"white\")\n# Add normal curve overlay\nboot_mean_nonchronic_mean &lt;- mean(boot_mean_nonchronic)\nboot_mean_nonchronic_sd &lt;- sd(boot_mean_nonchronic)\ncurve(dnorm(x, mean = boot_mean_nonchronic_mean, sd = boot_mean_nonchronic_sd), \n      col = \"darkblue\", lwd = 2, add = TRUE)\nlegend(\"topright\", legend = \"Normal Dist\", col = \"darkblue\", lwd = 2)\ndev.off()  # Close the saved figure\n\n\nquartz_off_screen \n                2 \n\n\n\n\n\nBootstrap Histogram\n\n\n\n\n\nT-Tests\n\nOriginal T-Test\n\n\nClick to see code\n# ===== PART 4: T-Tests =====\n# Original t-test\n# cat(\"\\n===== ORIGINAL T-TEST =====\\n\")\nt_test_result &lt;- t.test(group_chronic, group_nonchronic)\nprint(t_test_result)\n\n\n\n    Welch Two Sample t-test\n\ndata:  group_chronic and group_nonchronic\nt = -8.6312, df = 2928.5, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -132.09633  -83.18935\nsample estimates:\nmean of x mean of y \n 3202.622  3310.265 \n\n\n\n\nBootstrap T-Test\n\n\nClick to see code\n# Bootstrap t-test (comparing bootstrap distributions)\n# cat(\"\\n\\n===== BOOTSTRAP T-TEST =====\\n\")\nboot_t_test_result &lt;- t.test(boot_mean_chronic, boot_mean_nonchronic)\nprint(boot_t_test_result)\n\n\n\n    Welch Two Sample t-test\n\ndata:  boot_mean_chronic and boot_mean_nonchronic\nt = -861.4, df = 14306, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -107.8369 -107.3472\nsample estimates:\nmean of x mean of y \n 3202.628  3310.221 \n\n\n\n\n\n\nSummary Statistics\n\n\nClick to see code\n# Summary statistics\n# cat(\"\\n\\n===== SUMMARY STATISTICS =====\\n\")\ncat(\"Original Data:\\n\")\n\n\nOriginal Data:\n\n\nClick to see code\ncat(sprintf(\"  Chronic group: Mean = %.2f, SD = %.2f, n = %d\\n\", \n            mean_chronic, sd_chronic, n_chronic))\n\n\n  Chronic group: Mean = 3202.62, SD = 504.89, n = 1997\n\n\nClick to see code\ncat(sprintf(\"  Non-chronic group: Mean = %.2f, SD = %.2f, n = %d\\n\", \n            mean_nonchronic, sd_nonchronic, n_nonchronic))\n\n\n  Non-chronic group: Mean = 3310.27, SD = 472.42, n = 8003\n\n\nClick to see code\ncat(\"\\nBootstrap Distributions:\\n\")\n\n\n\nBootstrap Distributions:\n\n\nClick to see code\ncat(sprintf(\"  Chronic bootstrap: Mean = %.2f, SD = %.2f\\n\", \n            boot_mean_chronic_mean, boot_mean_chronic_sd))\n\n\n  Chronic bootstrap: Mean = 3202.63, SD = 11.28\n\n\nClick to see code\ncat(sprintf(\"  Non-chronic bootstrap: Mean = %.2f, SD = %.2f\\n\", \n            boot_mean_nonchronic_mean, boot_mean_nonchronic_sd))\n\n\n  Non-chronic bootstrap: Mean = 3310.22, SD = 5.37\n\n\n\n\n\n\nQuestion: Does the presence of maternal chronic conditions (diabetes and/or hypertension) significantly affect birth weight?\n\n\n\nNull hypothesis (\\(H_0\\)): The mean birth weight is equal across all four condition groups.\n\n\\[H_0: \\mu_{\\text{none}} = \\mu_{\\text{diabetes}} = \\mu_{\\text{hypertension}} = \\mu_{\\text{both}}\\]\n\nAlternative hypothesis (\\(H_1\\)):At least one condition group has a different mean birth weight compared to the others.\n\n\\[H_a: \\text{At least one } \\mu_i \\text{ is different}\\]\nSignificance level: \\(\\alpha = 0.05\\)\n\n\nData Preparation\n\n\nClick to see code\n# load data\nbirths &lt;- read.csv(\"data/cleaned/natality_cleaned.csv\")\n# head(births)\n\n\n\n\nClick to see code\n# Create condition groups for analysis\nbirths_clean &lt;- births |&gt;\n  mutate(\n    # CBinary indicators for any diabetes\n    has_diabetes = ifelse(rf_pdiab == TRUE | rf_gdiab == TRUE, 1, 0),\n    \n    # Binary indicator for any hypertension\n    has_hypertension = ifelse(rf_phype == TRUE | rf_ghype == TRUE | \n                              rf_ehype == TRUE, 1, 0),\n    \n    # Create 4 condition groups\n    condition_group = case_when(\n      has_diabetes == 0 & has_hypertension == 0 ~ \"No Conditions\",\n      has_diabetes == 1 & has_hypertension == 0 ~ \"Diabetes Only\",\n      has_diabetes == 0 & has_hypertension == 1 ~ \"Hypertension Only\",\n      has_diabetes == 1 & has_hypertension == 1 ~ \"Both Conditions\"\n    ),\n    \n    # Convert to factor w/ ordered levels\n    condition_group = factor(condition_group, \n                            levels = c(\"No Conditions\", \"Diabetes Only\", \n                                     \"Hypertension Only\", \"Both Conditions\"))\n  )\n\n# Check sample sizes\ntable(births_clean$condition_group)\n\n\n\n    No Conditions     Diabetes Only Hypertension Only   Both Conditions \n             8003               713              1066               218 \n\n\n\n\n\nAssumption Checks\nOne-way ANOVA requires three key assumptions:\n\nIndependence: Each observation is independent (already satisfied because each birth represents a separate individual)\nNormality: Birth weights within each group are approximately normally distributed\nHomogeneity of variance: All groups have equal variances\n\n\n\n\nNormality Check\n\n\nClick to see code\n# Q-Q plots for each group\npar(mfrow = c(2, 2))\nfor(group in levels(births_clean$condition_group)) {\n  data_subset &lt;- births_clean$dbwt[births_clean$condition_group == group]\n  qqnorm(data_subset, main = paste(\"Q-Q Plot:\", group))\n  qqline(data_subset, col = \"red\")\n}\n\n\n\n\n\n\n\n\n\nClick to see code\npar(mfrow = c(1, 1))\n\n\nThe Q-Q plots show that birth weights generally follow a normal distribution for all groups, with most points falling along the diagonal line.\n\n\n\nHomogeneity of Variance Check\n\n\nClick to see code\n# Levene's test\nlevene_result &lt;- leveneTest(dbwt ~ condition_group, data = births_clean)\nprint(levene_result)\n\n\nLevene's Test for Homogeneity of Variance (center = median)\n        Df F value    Pr(&gt;F)    \ngroup    3  5.4543 0.0009611 ***\n      9996                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe Levene’s test null hypothesis is that the groups have equal variances. Since F = 5.4543 and p = 0.0009611 (p &lt; 0.001), we reject the null and conclude that there is strong evidence that variances differ across the groups. The homogeneity of variance assumption is violated, so we will use Welch’s ANOVA, which is more robust to violations of the equal variance assumption.\n\n\n\nWelch’s ANOVA\n\n\nClick to see code\nwelch_result &lt;- oneway.test(dbwt ~ condition_group, data = births_clean, var.equal = FALSE)\nprint(welch_result)\n\n\n\n    One-way analysis of means (not assuming equal variances)\n\ndata:  dbwt and condition_group\nF = 41.96, num df = 3.00, denom df = 776.26, p-value &lt; 2.2e-16\n\n\nWelch’s ANOVA shows a highly significant difference in mean birth weight across the conditions levels (F = 41.96, num df = 3, denom df = 776.26, p &lt; 2.2e-16). Therefore, we reject H0 and have enough evidence to conclude that not all group means are equal.\n\n\n\nPost-Hoc Tests\n\n\nClick to see code\n# Use Games-Howell bc robust to unequal variances\ngames_howell &lt;- births_clean |&gt; games_howell_test(dbwt ~ condition_group)\nknitr::kable(games_howell, caption=\"Games-Howell Post-Hoc Test Results\")\n\n\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n\n\nWarning in attr(x, \"format\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n\n\n\nGames-Howell Post-Hoc Test Results\n\n\n\n\n\n\n\n\n\n\n\n\n.y.\ngroup1\ngroup2\nestimate\nconf.low\nconf.high\np.adj\np.adj.signif\n\n\n\n\ndbwt\nNo Conditions\nDiabetes Only\n-0.8459207\n-49.11684\n47.42499\n1.000\nns\n\n\ndbwt\nNo Conditions\nHypertension Only\n-174.6358196\n-216.30103\n-132.97061\n0.000\n****\n\n\ndbwt\nNo Conditions\nBoth Conditions\n-129.3478443\n-226.42518\n-32.27050\n0.004\n**\n\n\ndbwt\nDiabetes Only\nHypertension Only\n-173.7898989\n-234.55322\n-113.02657\n0.000\n****\n\n\ndbwt\nDiabetes Only\nBoth Conditions\n-128.5019236\n-235.05723\n-21.94662\n0.011\n*\n\n\ndbwt\nHypertension Only\nBoth Conditions\n45.2879753\n-58.49113\n149.06708\n0.673\nns\n\n\n\n\n\n\nThe post-hoc test showed the following:\n\nNo Conditions vs. Diabetes Only: Mean difference = -0.8 g, p = 1.00 (not significant)\n\nNo evidence of a meaningful difference in birth weight between mothers with diabetes only and those with no conditions.\n\nNo Conditions vs. Hypertension Only: Mean difference = -175 g, p &lt; 0.001\n\nMothers with hypertension only have infants about 175 g lighter on average than mothers with no conditions.\n\nNo Conditions vs. Both Conditions: Mean difference = -129 g, p = 0.004\n\nMothers with both diabetes and hypertension have infants about 129 g lighter on average than mothers with no conditions.\n\nDiabetes Only vs. Hypertension Only: Mean difference = -174 g, p = 4.61e-13\n\nMothers with hypertension only have infants about 174 g lighter on average than mothers with diabetes only.\n\nDiabetes Only vs. Both Conditions: Mean difference = -129 g, p = 0.011\n\nMothers with both conditions have infants about 129 g lighter on average than mothers with diabetes only.\n\nHypertension Only vs. Both Conditions: Mean difference = 45.3 g, p = 0.673 (not significant)\n\nNo evidence of a difference in mean birth weight between hypertension-only and both-conditions groups.\n\n\nMost comparisons involving the hypertension group show significant lower birth weights; the diabetes-only vs no-conditions comparison is not significant. This demonstrates taht maternal hypertension (alone or combined with diabetes) is associated with significantly lower infant birth weight, while diabetes alone does not differ significantly from no conditions."
  },
  {
    "objectID": "report.html",
    "href": "report.html",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "PDF cannot be displayed. Download instead."
  },
  {
    "objectID": "report.html#report",
    "href": "report.html#report",
    "title": "DSAN 5100 Final Project",
    "section": "",
    "text": "PDF cannot be displayed. Download instead."
  }
]